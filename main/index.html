<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hero with Click-to-Change Thumbnails</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: transparent;
      color: #fff;
      overflow-x: hidden; /* prevent horizontal scroll caused by the thumb rail */
    }

    /* HERO */
    .hero {
      width: 100%;
      height: 390px;            /* -10px */
      max-height: 80vh;
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      background-color: transparent;
      transition: background-image 0.5s ease-in-out;
      margin-bottom: 10px; /* no default spacing below hero */
      padding-bottom: 0;
    }

    .thumbnail-container {
      overflow: hidden;
      margin: 2px auto 0;       /* ðŸ”¹ tightened gap (was 4px) */
      background: transparent;
      box-sizing: border-box;
      height: 208px;
      position: relative;
    }

    .thumbnail-track {
      display: flex;
      align-items: flex-start;
      width: max-content;
      animation: scrollTrack 40s linear infinite;
      will-change: transform;
    }

    @keyframes scrollTrack {
      from { transform: translateX(0); }
      to   { transform: translateX(-50%); }
    }

    .thumbnail {
      margin: 0 5px;
      flex-shrink: 0;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      cursor: pointer;
    }

    .thumbnail img {
      max-height: 128px;
      max-width: 86px;
      width: auto;
      height: auto;
      object-fit: cover;
      flex-shrink: 0;
      display: block;
      transition: transform 0.2s;
    }

    .thumbnail img:hover {
      transform: scale(1.05);
    }

    .hidden-track {
      visibility: hidden;
      height: 0;
      overflow: hidden;
    }

    /* TABLET */
    @media (max-width: 1024px) {
      .hero {
        height: 410px; /* -10px from 420 */
        background-size: contain;
      }
      .thumbnail img {
        max-height: 166px;
        max-width: 136px;
      }
      .thumbnail {
        margin: 0 9px;
      }
      .thumbnail-container {
        height: 166px;
        margin-top: 2px; /* ðŸ”¹ tighter gap on tablet */
      }
    }

    /* MOBILE */
    @media (max-width: 600px) {
      .hero {
        height: calc(75vh - 10px);  /* ~10px smaller than original mobile height */
        max-height: none;
        background-position: center center;
        background-size: auto 95%;
      }
      .thumbnail img {
        max-height: 84px;
        max-width: 63px;
      }
      .thumbnail {
        margin: 0 3px;  /* small gaps between thumbs */
      }
      .thumbnail-container {
        height: 124px;
        margin-top: 1px; /* ðŸ”¹ minimal gap on mobile */
      }
    }
  </style>
</head>
<body>

  <div id="hero" class="hero"></div>

  <div class="thumbnail-container" id="thumbContainer">
    <div id="visibleTrack" class="thumbnail-track"></div>
  </div>

  <div class="hidden-track">
    <div id="hiddenTrack" class="thumbnail-track"></div>
  </div>

  <script>
    const allHeroImages = [
      "1.png","2.png","4.png","5.png",
      "6.png","7.png","8.png","9.png","10.png","11.png"
    ];

    const allDisplayThumbnails = [
      "1a.png","2a.png","4a.png","5a.png",
      "6a.png","7a.png","8a.png","9a.png","10a.png","11a.png"
    ];

    const heroImages = allHeroImages.slice(0, 11);
    const displayThumbnails = allDisplayThumbnails.slice(0, 11);

    const hero = document.getElementById('hero');
    const visibleTrack = document.getElementById('visibleTrack');
    const hiddenTrack = document.getElementById('hiddenTrack');
    const thumbContainer = document.getElementById('thumbContainer');

    // Duplicate for seamless [A A]
    const fullHeroList = [...heroImages, ...heroImages];
    const fullDisplayList = [...displayThumbnails, ...displayThumbnails];

    // Hidden track
    fullHeroList.forEach(src => {
      const thumb = document.createElement('div');
      thumb.className = 'thumbnail';
      const img = document.createElement('img');
      img.src = src;
      thumb.appendChild(img);
      hiddenTrack.appendChild(thumb);
    });

    // Visible track
    fullDisplayList.forEach((src, idx) => {
      const thumb = document.createElement('div');
      thumb.className = 'thumbnail';
      const img = document.createElement('img');
      img.src = src;
      thumb.appendChild(img);

      img.addEventListener('click', () => {
        const baseIndex = idx % heroImages.length;
        currentIndex = baseIndex;
        hero.style.backgroundImage = `url(${heroImages[currentIndex]})`;
        // removed resizeThumbsToHero() and restartCarousel() so carousel doesnâ€™t reset on click
      });

      visibleTrack.appendChild(thumb);
    });

    let currentIndex = 0;
    hero.style.backgroundImage = `url(${heroImages[currentIndex]})`;

    // Restart carousel
    function restartCarousel() {
      visibleTrack.style.animation = 'none';
      void visibleTrack.offsetWidth;
      visibleTrack.style.animation = 'scrollTrack 40s linear infinite';
      visibleTrack.style.animationPlayState = 'running';
    }

    // Resize thumbs to hero width
    function resizeThumbsToHero() {
      const heroW = hero.clientWidth;
      const heroH = hero.clientHeight;

      const img = new Image();
      img.onload = () => {
        let scaledW;
        if (window.matchMedia("(max-width: 600px)").matches) {
          const targetImgH = Math.round(heroH * 0.88);
          const scale = targetImgH / img.naturalHeight;
          scaledW = Math.round(img.naturalWidth * scale);
        } else {
          const scale = Math.min(heroW / img.naturalWidth, heroH / img.naturalHeight);
          scaledW = Math.round(img.naturalWidth * scale);
        }

        const leftOffset = Math.max(0, Math.round((heroW - scaledW) / 2));

        thumbContainer.style.width = `${scaledW}px`;
        thumbContainer.style.maxWidth = `${scaledW}px`;
        thumbContainer.style.marginLeft = `${leftOffset}px`;
        thumbContainer.style.marginRight = `0px`;

        const isMobile = window.matchMedia("(max-width:600px)").matches;
        const topGap = isMobile ? 1 : 2; // ðŸ”¹ minimal gaps
        thumbContainer.style.marginTop = `${topGap}px`;

        restartCarousel();
      };
      img.src = heroImages[currentIndex];
    }

    // Debounced resize
    let resizeTO;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTO);
      resizeTO = setTimeout(resizeThumbsToHero, 120);
    });

    // Initial layout
    requestAnimationFrame(() => {
      resizeThumbsToHero();
      visibleTrack.style.animationPlayState = 'running';
    });

    // Keep alive on tab switch
    document.addEventListener('visibilitychange', () => {
      if (!document.hidden) restartCarousel();
    });
  </script>

</body>
</html>
