<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hero with Click-to-Change Thumbnails</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: transparent;
      color: #fff;
      overflow-x: hidden; /* prevent horizontal scroll caused by the thumb rail */
    }

    .hero {
      width: 100%;
      height: 400px;
      max-height: 80vh;
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      background-color: transparent;
      transition: background-image 0.5s ease-in-out;
    }

    .thumbnail-container {
      overflow: hidden;
      margin: 10px auto 0;
      background: transparent;
      box-sizing: border-box;
      height: 208px;
      position: relative;
    }

    .thumbnail-track {
      display: flex;
      align-items: flex-start;
      width: max-content;
      animation: scrollTrack 40s linear infinite;
      will-change: transform;
    }

    @keyframes scrollTrack {
      from { transform: translateX(0); }
      to   { transform: translateX(-50%); }
    }

    .thumbnail {
      margin: 0 20px;
      flex-shrink: 0;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      cursor: pointer;
    }

    .thumbnail img {
      max-height: 208px;
      max-width: 166px;
      width: auto;
      height: auto;
      object-fit: cover;
      flex-shrink: 0;
      display: block;
      transition: transform 0.2s;
    }

    .thumbnail img:hover {
      transform: scale(1.05);
    }

    .hidden-track {
      visibility: hidden;
      height: 0;
      overflow: hidden;
    }

    @media (max-width: 1024px) {
      .hero {
        height: 420px; /* tablet portrait feel */
        background-size: contain;
      }
      .thumbnail img {
        max-height: 166px;
        max-width: 136px;
      }
      .thumbnail {
        margin: 0 9px;
      }
      .thumbnail-container {
        height: 166px;
      }
    }

    /* MOBILE: make the hero image occupy more of the hero area (narrow sidebars) */
    @media (max-width: 600px) {
      .hero {
        height: 75vh;               /* taller hero on phones */
        max-height: none;
        background-position: center center;
        background-size: auto 88%; /* scale image height to ~88% of hero -> narrows sidebars */
      }
      .thumbnail img {
        max-height: 124px;
        max-width: 103px;
      }
      /* small gap on mobile between thumbs */
      .thumbnail {
        margin: 0 3px;
      }
      .thumbnail-container {
        height: 124px;
      }
    }
  </style>
</head>
<body>

  <div id="hero" class="hero"></div>

  <div class="thumbnail-container" id="thumbContainer">
    <div id="visibleTrack" class="thumbnail-track"></div>
  </div>

  <div class="hidden-track">
    <div id="hiddenTrack" class="thumbnail-track"></div>
  </div>

  <script>
    const allHeroImages = [
      "1.png","2.png","4.png","5.png",
      "6.png","7.png","8.png","9.png","10.png","11.png"
    ];

    const allDisplayThumbnails = [
      "1a.png","2a.png","4a.png","5a.png",
      "6a.png","7a.png","8a.png","9a.png","10a.png","11a.png"
    ];

    const heroImages = allHeroImages.slice(0, 11);
    const displayThumbnails = allDisplayThumbnails.slice(0, 11);

    const hero = document.getElementById('hero');
    const visibleTrack = document.getElementById('visibleTrack');
    const hiddenTrack = document.getElementById('hiddenTrack');
    const thumbContainer = document.getElementById('thumbContainer');

    // Duplicate for seamless [A A]
    const fullHeroList = [...heroImages, ...heroImages];
    const fullDisplayList = [...displayThumbnails, ...displayThumbnails];

    // Hidden track (logic copy)
    fullHeroList.forEach(src => {
      const thumb = document.createElement('div');
      thumb.className = 'thumbnail';
      const img = document.createElement('img');
      img.src = src;
      thumb.appendChild(img);
      hiddenTrack.appendChild(thumb);
    });

    // Visible track (UI + click)
    fullDisplayList.forEach((src, idx) => {
      const thumb = document.createElement('div');
      thumb.className = 'thumbnail';
      const img = document.createElement('img');
      img.src = src;
      thumb.appendChild(img);

      img.addEventListener('click', () => {
        const baseIndex = idx % heroImages.length;
        currentIndex = baseIndex;
        hero.style.backgroundImage = `url(${heroImages[currentIndex]})`;
        resizeThumbsToHero();
        restartCarousel(); // ensure carousel is running after click
      });

      visibleTrack.appendChild(thumb);
    });

    let currentIndex = 0;
    hero.style.backgroundImage = `url(${heroImages[currentIndex]})`;

    // Keep carousel running â€” helper to restart animation if it was interrupted
    function restartCarousel() {
      visibleTrack.style.animation = 'none';
      void visibleTrack.offsetWidth; // force reflow
      visibleTrack.style.animation = 'scrollTrack 40s linear infinite';
      visibleTrack.style.animationPlayState = 'running';
    }

    // Resize / align function: set thumbnail-container width to the visible hero image width
    function resizeThumbsToHero() {
      const heroW = hero.clientWidth;
      const heroH = hero.clientHeight;

      const img = new Image();
      img.onload = () => {
        // compute 'contain' scale (but on mobile we use background-size:auto 88% which scales height first)
        // We'll derive the displayed image width based on whichever background-size rule is active.
        let scaledW;
        if (window.matchMedia("(max-width: 600px)").matches) {
          // mobile rule: background-size: auto 88% -> image height = 88% of heroH
          const targetImgH = Math.round(heroH * 0.88);
          const scale = targetImgH / img.naturalHeight;
          scaledW = Math.round(img.naturalWidth * scale);
        } else {
          // default 'contain' behaviour
          const scale = Math.min(heroW / img.naturalWidth, heroH / img.naturalHeight);
          scaledW = Math.round(img.naturalWidth * scale);
        }

        const leftOffset = Math.max(0, Math.round((heroW - scaledW) / 2));

        // Make the thumbnail container the same width as the visible hero image
        thumbContainer.style.width = `${scaledW}px`;
        thumbContainer.style.maxWidth = `${scaledW}px`;

        // Position it under the hero image's left edge using margin-left.
        // DO NOT set margin-right to leftOffset (that could expand the page width).
        thumbContainer.style.marginLeft = `${leftOffset}px`;
        thumbContainer.style.marginRight = `0px`;

        // ensure carousel continues
        restartCarousel();
      };
      img.src = heroImages[currentIndex];
    }

    // Debounced resize handler
    let resizeTO;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTO);
      resizeTO = setTimeout(() => {
        resizeThumbsToHero();
      }, 120);
    });

    // initial layout
    requestAnimationFrame(() => {
      resizeThumbsToHero();
      // ensure animation is running
      visibleTrack.style.animationPlayState = 'running';
    });

    // safety: if user navigates and animation somehow pauses, keep it alive
    document.addEventListener('visibilitychange', () => {
      if (!document.hidden) restartCarousel();
    });
  </script>

</body>
</html>
